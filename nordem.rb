# require 'rubygems'
# require 'encoding/character/utf8'


# Should do binary search but enough for now....

class Nordem
  
  @@accept_chars = {82=>true, 71=>true, 115=>true, 104=>true, 44=>true, 33=>true, 198=>true, 88=>true, 77=>true, 66=>true, 121=>true, 110=>true, 99=>true, 83=>true, 72=>true, 248=>true, 116=>true, 105=>true, 89=>true, 78=>true, 67=>true, 122=>true, 111=>true, 100=>true, 216=>true, 84=>true, 73=>true, 117=>true, 106=>true, 46=>true, 90=>true, 79=>true, 68=>true, 112=>true, 101=>true, 63=>true, 85=>true, 74=>true, 118=>true, 107=>true, 80=>true, 69=>true, 113=>true, 102=>true, 86=>true, 75=>true, 229=>true, 119=>true, 108=>true, 97=>true, 81=>true, 70=>true, 114=>true, 103=>true, 10=>true, 32=>true, 197=>true, 87=>true, 76=>true, 65=>true, 230=>true, 120=>true, 109=>true, 98=>true}
  @@stop_chars = {33=>true, 46=>true, 63=>true}
  @@whitespace_chars = {10=>true, 32=>true}
  
  @@bigrams = {71=>[[82, 0], [72, 0.0069204152249135], [116, 0.00865051903114187], [248, 0.0103806228373702], [105, 0.013840830449827], [111, 0.0363321799307958], [73, 0.122837370242215], [117, 0.124567474048443], [101, 0.370242214532872], [85, 0.396193771626298], [69, 0.401384083044983], [108, 0.408304498269896], [97, 0.484429065743945], [114, 0.856401384083045], [76, 0.97923875432526], [32, 0.982698961937716], [230, 0.991349480968858]], 82=>[[82, 0], [71, 0.0176991150442478], [104, 0.0309734513274336], [44, 0.0398230088495575], [121, 0.0442477876106195], [83, 0.0619469026548673], [105, 0.0663716814159292], [248, 0.0973451327433628], [67, 0.15929203539823], [111, 0.163716814159292], [73, 0.353982300884956], [84, 0.371681415929204], [117, 0.376106194690266], [79, 0.486725663716814], [101, 0.504424778761062], [80, 0.712389380530973], [69, 0.716814159292035], [75, 0.774336283185841], [97, 0.783185840707965], [65, 0.893805309734513], [32, 0.929203539823009], [230, 0.986725663716814]], 104=>[[115, 0], [121, 0.0010872519706442], [44, 0.00543625985322098], [116, 0.00761076379450938], [105, 0.0146779016036967], [248, 0.0508290296276162], [111, 0.0907855395487904], [106, 0.148409893992933], [117, 0.177493884207665], [46, 0.364501223158467], [101, 0.365588475129111], [118, 0.592552324001087], [108, 0.662680076107638], [97, 0.664582767056265], [114, 0.964392497961402], [32, 0.967654253873335], [230, 0.992932862190813]], 115=>[[104, 0], [115, 0.00235092968583031], [77, 0.0257533661038684], [99, 0.0258602265441334], [110, 0.0285317375507587], [66, 0.0362256892498397], [121, 0.0363325496901047], [44, 0.0412481299422954], [248, 0.0593075443470827], [105, 0.0647574268005984], [116, 0.164458217567856], [100, 0.335862363752939], [111, 0.338320153879034], [84, 0.38662107287882], [106, 0.386727933319085], [117, 0.387796537721735], [68, 0.391750374011541], [79, 0.391857234451806], [46, 0.391964094892071], [112, 0.410557811498183], [101, 0.428510365462706], [63, 0.545843128873691], [118, 0.546270570634751], [107, 0.554712545415687], [102, 0.621820901902116], [119, 0.624492412908741], [75, 0.624706133789271], [97, 0.624812994229536], [108, 0.821649925197692], [70, 0.840564223124599], [103, 0.840777944005129], [114, 0.84612096601838], [230, 0.847723872622355], [98, 0.849861081427656], [32, 0.852639452874546], [109, 0.990703141696944]], 88=>[[67, 0], [80, 0.5]], 99=>[[104, 0], [99, 0.120805369127517], [116, 0.154362416107383], [105, 0.402684563758389], [111, 0.446308724832215], [117, 0.614093959731544], [101, 0.630872483221476], [107, 0.788590604026846], [108, 0.800335570469799], [97, 0.832214765100671], [114, 0.902684563758389], [32, 0.924496644295302]], 33=>[[32, 0]], 198=>[[115, 0], [110, 0.0379746835443038], [100, 0.0632911392405063], [108, 0.113924050632911], [114, 0.746835443037975], [103, 0.860759493670886], [98, 0.987341772151899]], 77=>[[121, 0], [248, 0.00393184796854522], [105, 0.0773263433813893], [78, 0.145478374836173], [111, 0.146788990825688], [73, 0.260812581913499], [117, 0.264744429882045], [101, 0.300131061598951], [80, 0.515072083879423], [69, 0.516382699868938], [97, 0.522935779816514], [65, 0.973787680209699], [230, 0.979030144167759]], 121=>[[104, 0], [115, 0.00890207715133531], [121, 0.182987141444115], [44, 0.183976261127596], [110, 0.196834817012859], [105, 0.334322453016815], [116, 0.347181008902077], [111, 0.390702274975272], [100, 0.455984174085064], [117, 0.486646884272997], [112, 0.487636003956479], [46, 0.494559841740851], [101, 0.499505440158259], [107, 0.546983184965381], [118, 0.614243323442137], [102, 0.629080118694362], [119, 0.631058358061325], [97, 0.632047477744807], [108, 0.637982195845697], [114, 0.698318496538081], [103, 0.747774480712166], [230, 0.80811078140455], [98, 0.811078140454995], [109, 0.817012858555885], [32, 0.822947576656775]], 66=>[[82, 0], [121, 0.00204918032786885], [105, 0.021516393442623], [248, 0.0358606557377049], [111, 0.0686475409836066], [73, 0.157786885245902], [106, 0.160860655737705], [117, 0.164959016393443], [46, 0.192622950819672], [79, 0.194672131147541], [101, 0.195696721311475], [85, 0.310450819672131], [69, 0.313524590163934], [108, 0.318647540983607], [97, 0.36577868852459], [114, 0.892418032786885], [76, 0.975409836065574], [230, 0.976434426229508]], 44=>[[115, 0], [106, 0.000315656565656566], [109, 0.000631313131313131], [32, 0.000946969696969697]], 110=>[[104, 0], [115, 0.00162271805273834], [77, 0.0478701825557809], [99, 0.0479377958079784], [33, 0.0509803921568627], [66, 0.0510480054090602], [121, 0.0511156186612576], [110, 0.0573360378634212], [44, 0.0704530087897228], [83, 0.101149425287356], [248, 0.101217038539554], [72, 0.103177822853279], [105, 0.103313049357674], [116, 0.11737660581474], [78, 0.146855983772819], [111, 0.146923597025017], [100, 0.159567275185936], [106, 0.30446247464503], [117, 0.304800540906018], [68, 0.313252197430696], [112, 0.313319810682894], [46, 0.313860716700473], [101, 0.37762001352265], [107, 0.517579445571332], [63, 0.565990534144692], [118, 0.56788370520622], [80, 0.568762677484787], [102, 0.568830290736984], [75, 0.571534820824882], [108, 0.571602434077079], [97, 0.574712643678161], [114, 0.599526707234618], [70, 0.599932386747802], [103, 0.600067613252197], [230, 0.666328600405679], [98, 0.671467207572684], [109, 0.678769438810007], [32, 0.679513184584178]], 0=>[[73, 0]], 248=>[[104, 0], [115, 0.000592768227622999], [110, 0.042679312388856], [105, 0.0841730883224659], [116, 0.0847658565500889], [100, 0.0960284528749259], [106, 0.192649673977475], [46, 0.314759928867813], [101, 0.316538233550682], [118, 0.325429756965027], [107, 0.358624777711915], [102, 0.511558980438648], [108, 0.526970954356846], [103, 0.572614107883817], [114, 0.594546532305868], [32, 0.937166567871962], [109, 0.939537640782454], [98, 0.962062833432128]], 72=>[[121, 0], [105, 0.00776196636481242], [248, 0.0265200517464424], [111, 0.03751617076326], [84, 0.0989650711513583], [73, 0.0996119016817594], [106, 0.102846054333765], [117, 0.133247089262613], [79, 0.546571798188874], [101, 0.547218628719276], [118, 0.618369987063389], [69, 0.703104786545925], [97, 0.70633893919793], [114, 0.91267787839586], [32, 0.935316946959897], [65, 0.938551099611902], [109, 0.941138421733506], [230, 0.949547218628719]], 105=>[[104, 0], [115, 0.000318572793883402], [99, 0.0477859190825103], [44, 0.0577678666241903], [110, 0.0658383774025698], [248, 0.278645003716683], [116, 0.278857385579271], [83, 0.305086545609005], [122, 0.305192736540299], [100, 0.305298927471594], [111, 0.374960178400765], [117, 0.394180736965063], [84, 0.39481788255283], [112, 0.395030264415419], [46, 0.397472655835192], [101, 0.410958904109589], [63, 0.437825209727089], [118, 0.438037591589678], [107, 0.458426250398216], [113, 0.534777529998938], [102, 0.534883720930233], [97, 0.541148985876606], [108, 0.54741425082298], [114, 0.675692895826696], [103, 0.688648189444621], [120, 0.83646596580652], [109, 0.836572156737815], [98, 0.848677922905384], [230, 0.854412233195285], [32, 0.861633216523309]], 116=>[[71, 0], [104, 8.47026935456547e-05], [115, 0.02846010503134], [121, 0.0351516178214467], [33, 0.0426054548534643], [110, 0.0427748602405556], [44, 0.0479417245468406], [83, 0.0799593427070981], [248, 0.0800440454006437], [116, 0.0905471794003049], [105, 0.118414365576825], [100, 0.260121971878706], [122, 0.260376079959343], [111, 0.263764187701169], [84, 0.323056073183127], [106, 0.323140775876673], [117, 0.324157208199221], [112, 0.336015585295612], [46, 0.336862612231069], [101, 0.386328985261731], [107, 0.592071827884127], [63, 0.592325935964764], [118, 0.593681179061494], [102, 0.59512112485177], [119, 0.595883449093681], [108, 0.595968151787227], [75, 0.596645773335592], [97, 0.596730476029138], [103, 0.640691173979333], [114, 0.640775876672878], [120, 0.671268846349314], [109, 0.67135354904286], [98, 0.676859224123327], [230, 0.67719803489751], [32, 0.687616466203625]], 83=>[[99, 0], [110, 0.000766871165644172], [121, 0.0184049079754601], [83, 0.0352760736196319], [105, 0.0375766871165644], [248, 0.075920245398773], [116, 0.109662576687117], [67, 0.361963190184049], [111, 0.364263803680982], [73, 0.442484662576687], [84, 0.444018404907975], [117, 0.447085889570552], [106, 0.453220858895706], [46, 0.469325153374233], [101, 0.473926380368098], [112, 0.55521472392638], [85, 0.596625766871166], [118, 0.59739263803681], [107, 0.638036809815951], [69, 0.778374233128834], [108, 0.784509202453988], [97, 0.822085889570552], [103, 0.938650306748466], [32, 0.939417177914111], [76, 0.949386503067485], [230, 0.950153374233129], [109, 0.967024539877301]], 122=>[[105, 0], [46, 0.0232558139534884], [101, 0.0465116279069767]], 89=>[[44, 0], [110, 0.028169014084507], [111, 0.647887323943662], [84, 0.802816901408451], [79, 0.816901408450704], [32, 0.901408450704225]], 78=>[[71, 0], [44, 0.00571428571428571], [66, 0.00857142857142857], [121, 0.0171428571428571], [83, 0.0428571428571429], [105, 0.0542857142857143], [248, 0.114285714285714], [67, 0.128571428571429], [89, 0.137142857142857], [111, 0.148571428571429], [73, 0.168571428571429], [84, 0.174285714285714], [117, 0.202857142857143], [79, 0.317142857142857], [68, 0.331428571428571], [101, 0.357142857142857], [69, 0.485714285714286], [97, 0.494285714285714], [114, 0.928571428571428], [65, 0.931428571428571], [32, 0.934285714285714], [230, 0.945714285714286]], 67=>[[104, 0], [72, 0.2], [105, 0.272727272727273], [111, 0.381818181818182], [73, 0.527272727272727], [84, 0.581818181818182], [79, 0.727272727272727], [46, 0.763636363636364], [101, 0.781818181818182], [69, 0.8], [97, 0.909090909090909], [114, 0.927272727272727], [76, 0.945454545454546], [32, 0.981818181818182]], 100=>[[104, 0], [115, 0.000767918088737201], [77, 0.0329351535836178], [66, 0.0330204778156997], [121, 0.0331058020477816], [110, 0.0354095563139932], [44, 0.0411262798634812], [72, 0.054863481228669], [248, 0.0549488054607509], [105, 0.0593856655290102], [116, 0.081740614334471], [111, 0.136945392491468], [100, 0.148976109215017], [106, 0.16203071672355], [117, 0.162201365187713], [112, 0.175682593856655], [46, 0.176621160409556], [101, 0.195648464163823], [107, 0.741126279863481], [63, 0.742150170648464], [118, 0.742320819112628], [102, 0.742918088737201], [75, 0.745307167235495], [108, 0.745477815699659], [97, 0.747952218430034], [70, 0.783105802047782], [103, 0.783191126279864], [114, 0.783703071672355], [109, 0.801962457337884], [230, 0.803071672354949], [98, 0.804436860068259], [32, 0.805716723549488]], 111=>[[104, 0], [115, 0.000603500301750151], [121, 0.0208811104405552], [99, 0.0220881110440555], [44, 0.0246228123114062], [110, 0.0275196137598069], [105, 0.0898008449004224], [116, 0.0902836451418226], [111, 0.103077851538926], [100, 0.105009052504526], [106, 0.157030778515389], [84, 0.166807483403742], [117, 0.166928183464092], [68, 0.192637296318648], [79, 0.192757996378998], [101, 0.192878696439348], [46, 0.202293301146651], [112, 0.204103802051901], [63, 0.24103802051901], [107, 0.24115872057936], [118, 0.258177429088715], [102, 0.309474954737477], [119, 0.328666264333132], [97, 0.331321665660833], [108, 0.331804465902233], [70, 0.370307785153893], [103, 0.370428485214243], [114, 0.619191309595655], [98, 0.819674109837055], [32, 0.821605310802655], [109, 0.859505129752565]], 216=>[[110, 0], [106, 0.02], [101, 0.73], [118, 0.75], [108, 0.77], [114, 0.82], [109, 0.98]], 106=>[[104, 0], [115, 0.000798084596967279], [44, 0.0622505985634477], [110, 0.0853950518754988], [105, 0.160415003990423], [248, 0.162011173184358], [116, 0.167597765363128], [100, 0.221069433359936], [111, 0.23463687150838], [106, 0.359936153232243], [84, 0.36073423782921], [117, 0.361532322426177], [46, 0.373503591380686], [112, 0.386272944932163], [101, 0.388667198723065], [102, 0.826815642458101], [97, 0.827613727055068], [108, 0.877893056664006], [103, 0.920191540303272], [114, 0.925778132482043], [109, 0.946528332003192], [32, 0.948124501197127], [230, 0.979249800478851]], 117=>[[104, 0], [115, 0.000694766095414544], [33, 0.0974988420565076], [99, 0.0977304307549791], [44, 0.100509495136637], [110, 0.108846688281612], [116, 0.448124131542381], [105, 0.491662806855026], [111, 0.509263547938861], [100, 0.510421491431218], [117, 0.607920333487726], [112, 0.659564613246874], [101, 0.666512274201019], [46, 0.71861973135711], [63, 0.724409448818898], [107, 0.725335803612784], [118, 0.751042149143122], [102, 0.751968503937008], [97, 0.767253358036128], [108, 0.770727188513201], [114, 0.831403427512737], [103, 0.858036127836961], [230, 0.874015748031496], [120, 0.874247336729967], [32, 0.874478925428439], [98, 0.973830477072719], [109, 0.981241315423807]], 84=>[[82, 0], [104, 0.00706214689265537], [44, 0.144067796610169], [121, 0.146892655367232], [72, 0.15819209039548], [248, 0.177966101694915], [105, 0.203389830508475], [78, 0.402542372881356], [89, 0.403954802259887], [111, 0.412429378531073], [73, 0.548022598870057], [106, 0.559322033898305], [117, 0.562146892655367], [79, 0.581920903954802], [101, 0.586158192090396], [85, 0.620056497175141], [118, 0.621468926553672], [69, 0.625706214689266], [97, 0.635593220338983], [114, 0.800847457627119], [65, 0.942090395480226], [32, 0.944915254237288], [230, 0.967514124293785]], 73=>[[82, 0], [71, 0.0115384615384615], [77, 0.0192307692307692], [66, 0.0384615384615385], [44, 0.0538461538461538], [110, 0.0615384615384615], [83, 0.223076923076923], [116, 0.253846153846154], [67, 0.280769230769231], [78, 0.296153846153846], [100, 0.330769230769231], [84, 0.573076923076923], [73, 0.611538461538461], [79, 0.634615384615385], [68, 0.642307692307692], [118, 0.65], [107, 0.653846153846154], [69, 0.680769230769231], [102, 0.696153846153846], [86, 0.75], [97, 0.761538461538461], [108, 0.765384615384615], [70, 0.776923076923077], [103, 0.780769230769231], [76, 0.784615384615384], [65, 0.8], [109, 0.811538461538461], [32, 0.819230769230769]], 68=>[[44, 0], [121, 0.00150037509377344], [105, 0.00825206301575394], [248, 0.0210052513128282], [111, 0.0907726931732933], [73, 0.121530382595649], [106, 0.126781695423856], [117, 0.127531882970743], [79, 0.166541635408852], [46, 0.167291822955739], [101, 0.168042010502626], [69, 0.818454613653413], [97, 0.822205551387847], [114, 0.950487621905476], [65, 0.987246811702926], [32, 0.990247561890473], [230, 0.99774943735934]], 79=>[[82, 0], [104, 0.0346820809248555], [110, 0.0433526011560694], [83, 0.0578034682080925], [116, 0.0664739884393064], [78, 0.0895953757225433], [84, 0.104046242774566], [79, 0.115606936416185], [101, 0.11849710982659], [112, 0.121387283236994], [85, 0.144508670520231], [74, 0.164739884393064], [107, 0.173410404624277], [118, 0.176300578034682], [102, 0.205202312138728], [86, 0.236994219653179], [75, 0.239884393063584], [108, 0.242774566473988], [70, 0.251445086705202], [114, 0.277456647398844], [103, 0.407514450867052], [87, 0.890173410404624], [32, 0.893063583815029], [109, 0.904624277456648]], 112=>[[104, 0], [115, 0.0114345114345114], [33, 0.0176715176715177], [44, 0.0181912681912682], [121, 0.0233887733887734], [116, 0.0405405405405405], [248, 0.0613305613305613], [105, 0.0675675675675676], [100, 0.142411642411642], [111, 0.145010395010395], [106, 0.170997920997921], [117, 0.171517671517672], [46, 0.193866943866944], [112, 0.208939708939709], [101, 0.276507276507277], [118, 0.427234927234927], [102, 0.427754677754678], [119, 0.428794178794179], [108, 0.43035343035343], [97, 0.478170478170478], [103, 0.822245322245322], [114, 0.827442827442827], [109, 0.89033264033264], [230, 0.892411642411642], [32, 0.899168399168399]], 46=>[[66, 0], [110, 0.00016849199663016], [44, 0.00101095197978096], [116, 0.00185341196293176], [83, 0.00202190395956192], [111, 0.00269587194608256], [67, 0.00387531592249368], [122, 0.004212299915754], [112, 0.00438079191238416], [68, 0.00454928390901432], [79, 0.00471777590564448], [46, 0.00488626790227464], [69, 0.280202190395956], [70, 0.28390901432182], [103, 0.285593934288121], [65, 0.286267902274642], [32, 0.286436394271272]], 101=>[[115, 0], [104, 0.0274781624641935], [121, 0.0285390953778689], [77, 0.028751281960604], [99, 0.0287866463910599], [66, 0.0345864129858189], [198, 0.0360009902040528], [44, 0.0376984828659334], [110, 0.0627011351982176], [83, 0.265975881458429], [105, 0.266152703610708], [72, 0.266789263358914], [116, 0.266859992219825], [122, 0.357251476464971], [78, 0.357286840895427], [111, 0.357322205325883], [100, 0.358241680517735], [73, 0.438518937652509], [117, 0.438554302082965], [84, 0.438943310817979], [106, 0.439155497400714], [68, 0.450648937298865], [112, 0.45068430172932], [101, 0.452664709834848], [46, 0.455812144145418], [74, 0.484280510662376], [63, 0.485199985854228], [118, 0.486225554337447], [107, 0.500123775506595], [113, 0.503837040704459], [80, 0.504190685009018], [102, 0.504367507161297], [119, 0.512572055027053], [97, 0.512890334901156], [108, 0.515082929589418], [70, 0.546380450542844], [103, 0.546451179403755], [114, 0.564769954379884], [120, 0.709870212540227], [230, 0.710329950136153], [98, 0.710506772288432], [109, 0.713548113307635], [32, 0.73420094069385]], 85=>[[82, 0], [115, 0.00769230769230769], [104, 0.0230769230769231], [110, 0.0923076923076923], [83, 0.384615384615385], [116, 0.392307692307692], [67, 0.4], [78, 0.407692307692308], [100, 0.438461538461538], [84, 0.584615384615385], [46, 0.638461538461539], [68, 0.661538461538462], [112, 0.669230769230769], [69, 0.676923076923077], [102, 0.684615384615385], [108, 0.707692307692308], [114, 0.769230769230769], [103, 0.784615384615385], [65, 0.907692307692308], [32, 0.915384615384615], [76, 0.961538461538462], [98, 0.976923076923077]], 63=>[[106, 0], [46, 0.00775193798449612], [32, 0.0387596899224806]], 74=>[[248, 0], [111, 0.00592885375494071], [117, 0.0494071146245059], [101, 0.130434782608696], [69, 0.537549407114625], [97, 0.545454545454545], [230, 0.99802371541502]], 118=>[[104, 0], [115, 0.000753390256152687], [44, 0.0123053741838272], [121, 0.0170768458061276], [110, 0.0185836263184329], [248, 0.0374183827222501], [116, 0.0386740331491713], [105, 0.0444500251130085], [111, 0.160723254645907], [100, 0.212958312405826], [106, 0.288548468106479], [117, 0.288799598191863], [112, 0.2898041185334], [46, 0.290055248618785], [101, 0.298844801607233], [63, 0.619537920642893], [118, 0.619789050728277], [107, 0.62054244098443], [102, 0.622049221496735], [108, 0.622551481667504], [97, 0.632596685082873], [103, 0.853842290306379], [114, 0.854093420391763], [109, 0.858864892014063], [98, 0.860120542440985], [230, 0.860622802611753], [32, 0.905072827724762]], 107=>[[104, 0], [115, 0.00038587690526722], [99, 0.0191009068107274], [33, 0.019293845263361], [44, 0.0194867837159946], [121, 0.0337642292108817], [110, 0.0437970287478295], [248, 0.0557592128111133], [116, 0.0719660428323365], [105, 0.0964692263168049], [111, 0.105923210495852], [106, 0.192552575728343], [117, 0.194289021802045], [46, 0.237893112097241], [101, 0.249469419255258], [63, 0.552575728342659], [118, 0.552961605247926], [107, 0.554890989774262], [108, 0.693613737217827], [97, 0.710978197954852], [70, 0.868801852209145], [103, 0.868994790661779], [114, 0.869187729114412], [109, 0.892726220335713], [98, 0.892919158788346], [230, 0.89311209724098], [32, 0.905846035114798]], 113=>[[117, 0]], 69=>[[71, 0], [82, 0.00273224043715847], [115, 0.0245901639344262], [88, 0.0327868852459016], [44, 0.0382513661202186], [77, 0.0409836065573771], [66, 0.0546448087431694], [110, 0.0601092896174863], [83, 0.401639344262295], [116, 0.420765027322404], [67, 0.469945355191257], [78, 0.483606557377049], [100, 0.521857923497268], [73, 0.530054644808743], [117, 0.532786885245902], [106, 0.53551912568306], [46, 0.546448087431694], [68, 0.609289617486339], [74, 0.628415300546448], [107, 0.631147540983607], [80, 0.636612021857924], [69, 0.64207650273224], [102, 0.650273224043716], [86, 0.737704918032787], [108, 0.740437158469945], [81, 0.76775956284153], [70, 0.770491803278689], [103, 0.775956284153006], [114, 0.836065573770492], [120, 0.907103825136612], [65, 0.915300546448087], [32, 0.926229508196721], [109, 0.980874316939891]], 80=>[[71, 0], [82, 0.0028328611898017], [121, 0.00991501416430595], [72, 0.0198300283286119], [248, 0.0212464589235127], [105, 0.0226628895184136], [111, 0.188385269121813], [84, 0.25070821529745], [106, 0.252124645892351], [117, 0.254957507082153], [79, 0.293201133144476], [101, 0.296033994334278], [85, 0.375354107648725], [108, 0.378186968838527], [97, 0.446175637393768], [114, 0.730878186968839], [65, 0.991501416430595], [76, 0.992917847025496], [230, 0.997167138810198]], 102=>[[115, 0], [110, 0.00590783773139031], [121, 0.00669554942890902], [44, 0.0102402520677432], [248, 0.0126033871602993], [105, 0.0582906656163844], [116, 0.105947223316266], [100, 0.240645923591965], [111, 0.241039779440725], [117, 0.457660496258369], [106, 0.483654982276487], [46, 0.486805829066562], [101, 0.492713666797952], [107, 0.539582512800315], [118, 0.539976368649075], [102, 0.540764080346593], [108, 0.564395431272154], [97, 0.596297755021662], [114, 0.673887357227255], [98, 0.827097282394644], [230, 0.827884994092162], [32, 0.838125246159905]], 119=>[[115, 0], [104, 0.0362903225806452], [110, 0.112903225806452], [105, 0.141129032258065], [111, 0.42741935483871], [101, 0.75], [46, 0.806451612903226], [97, 0.842741935483871], [119, 0.879032258064516], [114, 0.919354838709677], [98, 0.943548387096774], [32, 0.951612903225806]], 86=>[[105, 0], [111, 0.287206266318538], [73, 0.360313315926893], [117, 0.368146214099217], [46, 0.370757180156658], [101, 0.373368146214099], [69, 0.744125326370757], [97, 0.759791122715405], [114, 0.91644908616188], [32, 0.924281984334204], [230, 0.926892950391645]], 75=>[[44, 0], [110, 0.000786163522012579], [121, 0.0188679245283019], [105, 0.0330188679245283], [248, 0.139937106918239], [111, 0.184748427672956], [73, 0.304245283018868], [117, 0.30503144654088], [106, 0.330188679245283], [101, 0.332547169811321], [118, 0.339622641509434], [108, 0.359276729559748], [97, 0.413522012578616], [114, 0.89937106918239], [32, 0.970125786163522], [230, 0.97248427672956]], 108=>[[104, 0], [115, 0.0016116035455278], [99, 0.0311576685468708], [110, 0.0314262691377921], [121, 0.0319634703196347], [44, 0.0502283105022831], [248, 0.0585549288208434], [116, 0.0793714746172442], [105, 0.128659683051303], [100, 0.235428417942519], [111, 0.316008595218909], [106, 0.351463873220521], [117, 0.35320977706151], [112, 0.373757722266989], [46, 0.37805533172173], [101, 0.388262154176739], [63, 0.628793983346763], [118, 0.628928283642224], [107, 0.648401826484018], [102, 0.657265645984421], [108, 0.658877249529949], [97, 0.764974482943863], [70, 0.845286059629331], [114, 0.845420359924792], [103, 0.845823260811174], [109, 0.849583669084072], [98, 0.854015578834274], [230, 0.862207896857373], [32, 0.885038947085684]], 97=>[[104, 0], [115, 0.0012539559324058], [33, 0.021078402101869], [121, 0.0211381142891264], [77, 0.0233474652176509], [99, 0.0234071774049083], [44, 0.0260345136442348], [110, 0.0457395354391831], [72, 0.167850958380605], [105, 0.168030094942378], [116, 0.197229354511256], [111, 0.280229294799068], [89, 0.280587567922613], [100, 0.282617782289365], [106, 0.324058040246014], [117, 0.324774586493103], [84, 0.325371708365678], [68, 0.325491132740192], [112, 0.325729981489222], [101, 0.335343643637667], [46, 0.344897593598854], [74, 0.354093270436496], [63, 0.354152982623754], [118, 0.35469039230907], [107, 0.387830656236938], [80, 0.401564459306144], [102, 0.401624171493402], [119, 0.425449334209112], [86, 0.426165880456201], [75, 0.426225592643459], [108, 0.426404729205231], [97, 0.484086702095898], [70, 0.629545590254971], [114, 0.629665014629486], [103, 0.738221771063474], [76, 0.825282140084791], [120, 0.825401564459306], [109, 0.825938974144623], [98, 0.858720964948946], [32, 0.870484265838658]], 81=>[[85, 0]], 103=>[[104, 0], [115, 0.0081407877409314], [77, 0.0319645636298336], [121, 0.032084281096612], [44, 0.040703938704657], [110, 0.0610559080569855], [248, 0.0964922782233928], [116, 0.100083802226745], [105, 0.1574284688136], [111, 0.193343708847121], [100, 0.202561953789058], [117, 0.310187956422842], [106, 0.318448461630552], [112, 0.322039985633904], [46, 0.322159703100682], [101, 0.340356758051], [63, 0.554890458517898], [118, 0.555848198252125], [107, 0.556446785586017], [102, 0.557883395187358], [75, 0.559439722255477], [108, 0.559559439722256], [97, 0.57572129773734], [70, 0.616904106309111], [114, 0.617382976176224], [103, 0.636657488327547], [230, 0.647791212737939], [109, 0.648389800071831], [98, 0.649586974739615], [32, 0.650185562073507]], 70=>[[44, 0], [121, 0.00119189511323004], [248, 0.00834326579261025], [105, 0.034564958283671], [111, 0.0715137067938021], [73, 0.274135876042908], [106, 0.275327771156138], [117, 0.282479141835518], [79, 0.296781883194279], [46, 0.302741358760429], [101, 0.31823599523242], [85, 0.3373063170441], [108, 0.34088200238379], [97, 0.383790226460071], [114, 0.485101311084625], [32, 0.978545887961859], [230, 0.99046483909416]], 114=>[[104, 0], [115, 0.00293470286133529], [99, 0.0239667400342382], [33, 0.0257601695606098], [121, 0.0259232086084617], [44, 0.0335860438575039], [110, 0.0591831743702617], [83, 0.0996983777614739], [116, 0.0997798972853998], [248, 0.139887503056982], [105, 0.168419336431075], [100, 0.214233308877476], [111, 0.242194505584087], [106, 0.276106627537295], [117, 0.276269666585147], [79, 0.309611151870873], [112, 0.309692671394799], [46, 0.311078503301541], [101, 0.343523273824081], [74, 0.488383467840548], [118, 0.488464987364474], [63, 0.495720224993886], [107, 0.496943017852776], [80, 0.524904214559387], [102, 0.524985734083313], [75, 0.52767587837287], [119, 0.527757397896796], [108, 0.527920436944648], [97, 0.537050623624358], [103, 0.600228254666993], [114, 0.617347354691449], [76, 0.631939349474199], [98, 0.632020868998125], [230, 0.637727235672944], [32, 0.65949294856118], [109, 0.9833700171191]], 87=>[[104, 0], [78, 0.1875], [73, 0.25], [101, 0.375], [79, 0.6875], [65, 0.75]], 120=>[[99, 0], [105, 0.107142857142857], [116, 0.178571428571429], [112, 0.285714285714286], [101, 0.535714285714286], [102, 0.714285714285714], [32, 0.75]], 76=>[[104, 0], [44, 0.0102489019033675], [121, 0.0131771595900439], [105, 0.120058565153734], [248, 0.468521229868228], [111, 0.537335285505124], [73, 0.689604685212299], [117, 0.707174231332357], [101, 0.774524158125915], [85, 0.816983894582723], [69, 0.818448023426061], [97, 0.821376281112738], [65, 0.957540263543192], [32, 0.961932650073206], [76, 0.967789165446559], [230, 0.972181551976574]], 230=>[[115, 0], [44, 0.126027397260274], [110, 0.127397260273973], [116, 0.337671232876712], [100, 0.375342465753425], [46, 0.471232876712329], [101, 0.476027397260274], [112, 0.501369863013699], [107, 0.514383561643836], [118, 0.567123287671233], [102, 0.583561643835616], [108, 0.59041095890411], [103, 0.662328767123288], [114, 0.702054794520548], [32, 0.965753424657534], [230, 0.968493150684932], [109, 0.969178082191781], [98, 0.986986301369863]], 98=>[[115, 0], [44, 0.00334821428571429], [110, 0.00669642857142857], [121, 0.02734375], [248, 0.0446428571428571], [105, 0.0647321428571429], [116, 0.0931919642857143], [111, 0.12890625], [106, 0.192522321428571], [117, 0.193080357142857], [46, 0.225446428571429], [101, 0.229910714285714], [80, 0.513950892857143], [97, 0.514508928571428], [108, 0.624441964285714], [114, 0.877232142857143], [109, 0.948660714285714], [230, 0.949776785714286], [32, 0.963169642857143], [98, 0.991629464285714]], 109=>[[104, 0], [115, 0.00227790432801822], [33, 0.0169807413543177], [121, 0.0171878235659557], [110, 0.0173949057775937], [44, 0.0184303168357838], [248, 0.0381031269413957], [116, 0.0496997307931249], [105, 0.0662663077241665], [111, 0.123835162559536], [100, 0.152826672188859], [106, 0.153862083247049], [117, 0.154069165458687], [46, 0.16421619382895], [112, 0.188444812590598], [101, 0.208945951542762], [118, 0.497204390142887], [107, 0.497411472354525], [63, 0.499068130047629], [102, 0.500517705529095], [108, 0.501760198798923], [97, 0.536757092565749], [114, 0.626423690205011], [103, 0.633257403189066], [98, 0.63387864982398], [230, 0.636777800786912], [109, 0.644854007040795], [32, 0.739076413336094]], 65=>[[71, 0], [82, 0.0108864696734059], [115, 0.0217729393468118], [66, 0.0248833592534992], [77, 0.0279937791601866], [110, 0.0326594090202177], [83, 0.153965785381026], [116, 0.160186625194401], [67, 0.174183514774495], [78, 0.181959564541213], [100, 0.19751166407465], [84, 0.200622083981337], [73, 0.206842923794712], [117, 0.208398133748056], [106, 0.211508553654743], [46, 0.213063763608087], [68, 0.214618973561431], [112, 0.217729393468118], [107, 0.220839813374806], [118, 0.223950233281493], [80, 0.228615863141524], [102, 0.230171073094868], [75, 0.312597200622084], [86, 0.314152410575428], [97, 0.315707620528771], [108, 0.438569206842924], [70, 0.489891135303266], [103, 0.49144634525661], [114, 0.724727838258165], [76, 0.856920684292379], [109, 0.86158631415241], [98, 0.870917573872473]], 32=>[[71, 0], [82, 0.0132240772663943], [104, 0.0173566014121425], [115, 0.0843979502680237], [44, 0.188325028927669], [99, 0.188443101046119], [198, 0.191796349210098], [121, 0.192528396344487], [77, 0.194039719460647], [66, 0.211608850685999], [110, 0.23335773490448], [248, 0.248376508371313], [72, 0.248848796845113], [105, 0.284695492006518], [116, 0.3262568777009], [83, 0.362930077691454], [89, 0.392684251540841], [100, 0.393321840980471], [78, 0.448343448178147], [67, 0.455498618556214], [111, 0.456207051266914], [216, 0.516046000897348], [73, 0.518407443266347], [106, 0.522965027038515], [117, 0.529152006045292], [84, 0.539943797671618], [46, 0.555127872104281], [68, 0.561314851111059], [79, 0.592084445179115], [112, 0.599357687675632], [101, 0.617517179493234], [85, 0.649845325524831], [107, 0.652395683283349], [118, 0.670295416440362], [74, 0.704772475027747], [69, 0.715965711856802], [80, 0.722176305287269], [102, 0.738493872057052], [119, 0.76779937185633], [86, 0.772191654662668], [97, 0.781070677970104], [75, 0.817129902944719], [108, 0.846836847946726], [114, 0.867098023472737], [103, 0.876921623727773], [70, 0.899071953148983], [87, 0.917963492100975], [230, 0.918317708456325], [76, 0.918860840201195], [109, 0.934422745412898], [98, 0.964365834651805], [65, 0.985760502514936]]}
  
  def self.draw_from_weighted_array(a)
      # p a
      r = rand
      if a.length == 0
        return nil
      end
      i = a.length-1
      while i>0 && a[i][1] > r 
        i -= 1
      end
      return a[i][0]
  end

  def self.build_weighted_array(occurences)
    sum = 0.0
    occurences.each_value {|v| sum += v}
    ret = []
    dist = 0
    occurences.each_pair {|k,v| ret.push([k,dist]); dist += v/sum}
    return ret
  end

  def self.accept(c)
    return @@accept_chars[c]
  end

  def self.stop(c)
    return @@stop_chars[c]
  end
  
  def self.space(c)
    return @@whitespace_chars[c]
  end

  def self.count_string(string)
    occ = {}
    string.unpack('U*').each do |c|
      if accept(c)
        occ[c] = occ[c].to_i + 1
      end
    end
    return occ
  end

  def self.count_file(filename) 
    occ = {}
    last = 0
    File.open(filename,'r') do |f|
      f.each do |l|
        l.unpack('U*').each do |c|
          if accept(c)
            if space(c) 
              c = 32
              if space(last.last)
                next
              end
            end
            if last != 0
              occ[last] ||= {}
              occ[last][c] = occ[last][c].to_i + 1
            end
            last = c
          end
        end
      end
    end
    return occ
  end
 
  def self.build_stats(filename)
    occ = count_file(filename)
    occ.each_key do |k|
      occ[k] = build_weighted_array(occ[k])
    end
    return occ
  end
  
  def self.gibberish(n)
    c = draw_from_weighted_array(@@bigrams[46])
    out = []
    out.push(c)
    while out.length<n
      while !stop(c)
        # p c 
        # p @@bigrams[c]
        c = draw_from_weighted_array(@@bigrams[c])
        out.push(c)
      end
      # out.push(46)
      c = draw_from_weighted_array(@@bigrams[46])
      out.push(c)
    end
    return out.pack('U*')
  end
  
end

# legal = {}
# ARGF.each do |l|
#   l.unpack('U*').each do |c|
#     legal[c] = true
#   end
# end
# p legal
# p Nordem.build_stats(ARGV[0])
print "\n"
print Nordem.gibberish(100)
print "\n\n"
